---
layout: page
title: TryHackMe x86-64
permalink: /x86/
---

https://tryhackme.com/room/introtox8664

Task 1: 
Start the VM
Task 2: 
First you run r2 and set the sytax this time we used the att syntax.

Command: r2 -d intro
 
 ```
[0x7f43dcc44090]> e asm.syntax=att

```
Next you list the functions using afl

```

[0x7f43dcc44090]> afl
0x556f2e0d9560    1 42           entry0
0x556f2e2d9fe0    1 4124         reloc.__libc_start_main
0x556f2e0d9590    4 50   -> 40   sym.deregister_tm_clones
0x556f2e0d95d0    4 66   -> 57   sym.register_tm_clones
0x556f2e0d9620    5 58   -> 51   entry.fini0
0x556f2e0d9550    1 6            sym..plt.got
0x556f2e0d9660    1 10           entry.init0
0x556f2e0d9730    1 2            sym.__libc_csu_fini
0x556f2e0d9734    1 9            sym._fini
0x556f2e0d96c0    4 101          sym.__libc_csu_init
0x556f2e0d966a    1 78           main
0x556f2e0d9540    1 6            sym.imp.__printf_chk
0x556f2e0d9510    3 23           sym._init
0x556f2e0d9000    3 97   -> 123  map.home_tryhackme_introduction_intro.r_x
[0x7f43dcc44090]>
``` 
The main function is likely what were are looking for we can use pdf "print disassembly function" to view the code 
```
[0x7f43dcc44090]> pdf @main
/ (fcn) main 78
|   int main (int argc, char **argv, char **envp);
|           ; DATA XREF from entry0 (0x556f2e0d957d)
|           0x556f2e0d966a      4883ec08       subq $8, %rsp
|           0x556f2e0d966e      b902000000     movl $2, %ecx
|           0x556f2e0d9673      ba01000000     movl $1, %edx
|           0x556f2e0d9678      488d35c90000.  leaq str.value_for_a_is__d_and_b_is__d, %rsi ; 0x556f2e0d9748 ; "value for a is %d and b is %d\n"                                                                                    
|           0x556f2e0d967f      bf01000000     movl $1, %edi
|           0x556f2e0d9684      b800000000     movl $0, %eax
|           0x556f2e0d9689      e8b2feffff     callq sym.imp.__printf_chk
|           0x556f2e0d968e      b901000000     movl $1, %ecx
|           0x556f2e0d9693      ba02000000     movl $2, %edx
|           0x556f2e0d9698      488d35c90000.  leaq str.value_of_a_is__d_and_b_is__d, %rsi ; 0x556f2e0d9768 ; "value of a is %d and b is %d\n"                                                                                      
|           0x556f2e0d969f      bf01000000     movl $1, %edi
|           0x556f2e0d96a4      b800000000     movl $0, %eax
|           0x556f2e0d96a9      e892feffff     callq sym.imp.__printf_chk
|           0x556f2e0d96ae      b800000000     movl $0, %eax
|           0x556f2e0d96b3      4883c408       addq $8, %rsp
\           0x556f2e0d96b7      c3             retq
```
Lets break down what this means:

Left looks like 0x556f2e0d966a is the memory addresses of instructions
Middle looks like 4883ec08 is the instructions encoded in bytes
Right looks like  subq $8, %rsp is the human-readable instructions

The human-readable instructions are what program is using to
transfer data between memory and register and vice versa
perform arithmetic operations on registers/data

The task goes on to explain what each register is, the most commonly used, and some of the commands like movl $2 %edx


Taks 4: If statements (continued)

Command = r2 -d if1

Again we use afl to print the functions in the program. 
```
[0x7f91d1500090]> afl
0x55f0c657b4f0    1 42           entry0
0x55f0c677bfe0    1 4124         reloc.__libc_start_main
0x55f0c657b520    4 50   -> 40   sym.deregister_tm_clones
0x55f0c657b560    4 66   -> 57   sym.register_tm_clones
0x55f0c657b5b0    5 58   -> 51   entry.fini0
0x55f0c657b4e0    1 6            sym.imp.__cxa_finalize
0x55f0c657b5f0    1 10           entry.init0
0x55f0c657b6a0    1 2            sym.__libc_csu_fini
0x55f0c657b6a4    1 9            sym._fini
0x55f0c657b630    4 101          sym.__libc_csu_init
0x55f0c657b5fa    4 43           main
0x55f0c657b4b8    3 23           sym._init
```
The list contains a main function so we use pdf@ main to view the code again. 
```
[0x7f91d1500090]> pdf @main
/ (fcn) main 43
|   int main (int argc, char **argv, char **envp);
|           ; var int32_t var_8h @ rbp-0x8
|           ; var int32_t var_4h @ rbp-0x4
|           ; DATA XREF from entry0 (0x55f0c657b50d)
|           0x55f0c657b5fa      55             pushq %rbp
|           0x55f0c657b5fb      4889e5         movq %rsp, %rbp
|           0x55f0c657b5fe      c745f8030000.  movl $3, var_8h
|           0x55f0c657b605      c745fc040000.  movl $4, var_4h
|           0x55f0c657b60c      8b45f8         movl var_8h, %eax
|           0x55f0c657b60f      3b45fc         cmpl var_4h, %eax
|       ,=< 0x55f0c657b612      7d06           jge 0x55f0c657b61a
|       |   0x55f0c657b614      8345f805       addl $5, var_8h
|      ,==< 0x55f0c657b618      eb04           jmp 0x55f0c657b61e
|      |`-> 0x55f0c657b61a      8345fc03       addl $3, var_4h
|      |    ; CODE XREF from main (0x55f0c657b618)
|      `--> 0x55f0c657b61e      b800000000     movl $0, %eax
|           0x55f0c657b623      5d             popq %rbp
\           0x55f0c657b624      c3             retq
```
The program has jge and jmp instructions that we want to look at we can use db 0x55f0c657b612 and db 0x55f0c657b618 to set breakpoints on them and dc to run the program to the first breakpoint:
jge is jump if greater than or equal to 
jmp is an unconditional jump 

```
[0x7f91d1500090]> db 0x55f0c657b612
[0x7f91d1500090]> db 0x55f0c657b618
[0x7f91d1500090]> dc
hit breakpoint at: 55f0c657b612
```
The program will stop and you can use dr to view the current contents of each register: 
```
[0x55f0c657b612]> dr
rax = 0x00000003
rbx = 0x00000000
rcx = 0x55f0c657b630
rdx = 0x7fffd476a6b8
r8 = 0x7f91d14fad80
r9 = 0x7f91d14fad80
r10 = 0x00000000
r11 = 0x00000000
r12 = 0x55f0c657b4f0
r13 = 0x7fffd476a6a0
r14 = 0x00000000
r15 = 0x00000000
rsi = 0x7fffd476a6a8
rdi = 0x00000001
rsp = 0x7fffd476a5c0
rbp = 0x7fffd476a5c0
rip = 0x55f0c657b612
rflags = 0x00000297
orax = 0xffffffffffffffff
```

```
[0x7f8ad7e5f090]> db 0x55833d334637
[0x7f8ad7e5f090]> dc
hit breakpoint at: 55833d334637
[0x55833d334637]> px @ rbp-0x8
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7ffdc902ee48  6000 0000 0100 0000 4046 333d 8355 0000  `.......@F3=.U..
0x7ffdc902ee58  97eb a8d7 8a7f 0000 0100 0000 0000 0000  ................
0x7ffdc902ee68  38ef 02c9 fd7f 0000 0080 0000 0100 0000  8...............
0x7ffdc902ee78  fa45 333d 8355 0000 0000 0000 0000 0000  .E3=.U..........
0x7ffdc902ee88  6f9a b029 2da1 23c3 f044 333d 8355 0000  o..)-.#..D3=.U..
0x7ffdc902ee98  30ef 02c9 fd7f 0000 0000 0000 0000 0000  0...............
0x7ffdc902eea8  0000 0000 0000 0000 6f9a f079 4e49 de97  ........o..yNI..
0x7ffdc902eeb8  6f9a ae73 1a74 3097 0000 0000 fd7f 0000  o..s.t0.........
0x7ffdc902eec8  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffdc902eed8  33e7 e6d7 8a7f 0000 3846 e5d7 8a7f 0000  3.......8F......
0x7ffdc902eee8  b7e5 0700 0000 0000 0000 0000 0000 0000  ................
0x7ffdc902eef8  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffdc902ef08  f044 333d 8355 0000 30ef 02c9 fd7f 0000  .D3=.U..0.......
0x7ffdc902ef18  1a45 333d 8355 0000 28ef 02c9 fd7f 0000  .E3=.U..(.......
0x7ffdc902ef28  1c00 0000 0000 0000 0100 0000 0000 0000  ................
0x7ffdc902ef38  81f7 02c9 fd7f 0000 0000 0000 0000 0000  ................
```
The next two commands will give you the value of var_ch and var_4h they are declared in the top of the main function: 
```
[0x55833d334637]> px @rbp-0x4
[0x55833d334637]> px @ rbp-0x8
```
```
[0x55833d334637]> px @rbp-0xc
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7ffdc902ee44  0000 0000 6000 0000 0100 0000 4046 333d  ....`.......@F3=
0x7ffdc902ee54  8355 0000 97eb a8d7 8a7f 0000 0100 0000  .U..............
0x7ffdc902ee64  0000 0000 38ef 02c9 fd7f 0000 0080 0000  ....8...........
0x7ffdc902ee74  0100 0000 fa45 333d 8355 0000 0000 0000  .....E3=.U......
0x7ffdc902ee84  0000 0000 6f9a b029 2da1 23c3 f044 333d  ....o..)-.#..D3=
0x7ffdc902ee94  8355 0000 30ef 02c9 fd7f 0000 0000 0000  .U..0...........
0x7ffdc902eea4  0000 0000 0000 0000 0000 0000 6f9a f079  ............o..y
0x7ffdc902eeb4  4e49 de97 6f9a ae73 1a74 3097 0000 0000  NI..o..s.t0.....
0x7ffdc902eec4  fd7f 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffdc902eed4  0000 0000 33e7 e6d7 8a7f 0000 3846 e5d7  ....3.......8F..
0x7ffdc902eee4  8a7f 0000 b7e5 0700 0000 0000 0000 0000  ................
0x7ffdc902eef4  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffdc902ef04  0000 0000 f044 333d 8355 0000 30ef 02c9  .....D3=.U..0...
0x7ffdc902ef14  fd7f 0000 1a45 333d 8355 0000 28ef 02c9  .....E3=.U..(...
0x7ffdc902ef24  fd7f 0000 1c00 0000 0000 0000 0100 0000  ................
0x7ffdc902ef34  0000 0000 81f7 02c9 fd7f 0000 0000 0000  ................
```
What is the value of var_8h before the popq and ret instructions?
96
what is the value of var_ch before the popq and ret instructions?
0
What is the value of var_4h before the popq and ret instructions?
1
What operator is used to change the value of var_8h, input the symbol as your answer(symbols include +, -, *, /, &, |):
Answer: &

Task 5 Loops:

Command = r2 -d loop1

We list the functions with afl again:

```
[0x7fcfb9de1090]> afl
0x556738e614f0    1 42           entry0
0x556739061fe0    1 4124         reloc.__libc_start_main
0x556738e61520    4 50   -> 40   sym.deregister_tm_clones
0x556738e61560    4 66   -> 57   sym.register_tm_clones
0x556738e615b0    5 58   -> 51   entry.fini0
0x556738e614e0    1 6            sym.imp.__cxa_finalize
0x556738e615f0    1 10           entry.init0
0x556738e616a0    1 2            sym.__libc_csu_fini
0x556738e616a4    1 9            sym._fini
0x556738e61630    4 101          sym.__libc_csu_init
0x556738e615fa    4 44           main
0x556738e614b8    3 23           sym._init
[0x7fcfb9de1090]> pdf @main
/ (fcn) main 44
|   int main (int argc, char **argv, char **envp);
|           ; var int32_t var_ch @ rbp-0xc
|           ; var int32_t var_8h @ rbp-0x8
|           ; var int32_t var_4h @ rbp-0x4
|           ; DATA XREF from entry0 (0x556738e6150d)
|           0x556738e615fa      55             pushq %rbp
|           0x556738e615fb      4889e5         movq %rsp, %rbp
|           0x556738e615fe      c745f4040000.  movl $4, var_ch
|           0x556738e61605      c745f8090000.  movl $9, var_8h
|           0x556738e6160c      c745fc0a0000.  movl $0xa, var_4h
|       ,=< 0x556738e61613      eb04           jmp 0x556738e61619
|      .--> 0x556738e61615      8345f402       addl $2, var_ch
|      :|   ; CODE XREF from main (0x556738e61613)
|      :`-> 0x556738e61619      837df408       cmpl $8, var_ch
|      `==< 0x556738e6161d      7ef6           jle 0x556738e61615
|           0x556738e6161f      b800000000     movl $0, %eax
|           0x556738e61624      5d             popq %rbp
\           0x556738e61625      c3             retq
```
Now set a breakpoint at the jmp again with the db command
 
```
[0x7fcfb9de1090]> db 0x556738e61613
```
Now use ds and px @rbp-0xc a few times to see the increments of var_ch

```
[0x556738e61613]> ds
[0x556738e61613]> px @rbp-0xc
offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7ffefa3a7a44  0400 0000 0900 0000 0a00 0000 3016 e638  ............0..8
0x7ffefa3a7a54  6755 0000 970b a1b9 cf7f 0000 0100 0000  gU..............
0x7ffefa3a7a64  0000 0000 387b 3afa fe7f 0000 0080 0000  ....8{:.........
0x7ffefa3a7a74  0100 0000 fa15 e638 6755 0000 0000 0000  .......8gU......
0x7ffefa3a7a84  0000 0000 1a35 7d04 73a8 c4bd f014 e638  .....5}.s......8
0x7ffefa3a7a94  6755 0000 307b 3afa fe7f 0000 0000 0000  gU..0{:.........
0x7ffefa3a7aa4  0000 0000 0000 0000 0000 0000 1a35 dddc  .............5..
0x7ffefa3a7ab4  cb2d f7e8 1a35 833e fdaa 95e8 0000 0000  .-...5.>........
0x7ffefa3a7ac4  fe7f 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffefa3a7ad4  0000 0000 3307 dfb9 cf7f 0000 3866 ddb9  ....3.......8f..
0x7ffefa3a7ae4  cf7f 0000 8852 0700 0000 0000 0000 0000  .....R..........
0x7ffefa3a7af4  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffefa3a7b04  0000 0000 f014 e638 6755 0000 307b 3afa  .......8gU..0{:.
0x7ffefa3a7b14  fe7f 0000 1a15 e638 6755 0000 287b 3afa  .......8gU..({:.
0x7ffefa3a7b24  fe7f 0000 1c00 0000 0000 0000 0100 0000  ................
0x7ffefa3a7b34  0000 0000 8387 3afa fe7f 0000 0000 0000  ......:.........
[0x556738e61613]> ds
[0x556738e61613]> ds
[0x556738e61613]> px @rbp-0xc
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7ffefa3a7a44  0600 0000 0900 0000 0a00 0000 3016 e638  ............0..8
0x7ffefa3a7a54  6755 0000 970b a1b9 cf7f 0000 0100 0000  gU..............
0x7ffefa3a7a64  0000 0000 387b 3afa fe7f 0000 0080 0000  ....8{:.........
0x7ffefa3a7a74  0100 0000 fa15 e638 6755 0000 0000 0000  .......8gU......
0x7ffefa3a7a84  0000 0000 1a35 7d04 73a8 c4bd f014 e638  .....5}.s......8
0x7ffefa3a7a94  6755 0000 307b 3afa fe7f 0000 0000 0000  gU..0{:.........
0x7ffefa3a7aa4  0000 0000 0000 0000 0000 0000 1a35 dddc  .............5..
0x7ffefa3a7ab4  cb2d f7e8 1a35 833e fdaa 95e8 0000 0000  .-...5.>........
0x7ffefa3a7ac4  fe7f 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffefa3a7ad4  0000 0000 3307 dfb9 cf7f 0000 3866 ddb9  ....3.......8f..
0x7ffefa3a7ae4  cf7f 0000 8852 0700 0000 0000 0000 0000  .....R..........
0x7ffefa3a7af4  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffefa3a7b04  0000 0000 f014 e638 6755 0000 307b 3afa  .......8gU..0{:.
0x7ffefa3a7b14  fe7f 0000 1a15 e638 6755 0000 287b 3afa  .......8gU..({:.
0x7ffefa3a7b24  fe7f 0000 1c00 0000 0000 0000 0100 0000  ................
0x7ffefa3a7b34  0000 0000 8387 3afa fe7f 0000 0000 0000  ......:.........
[0x556738e61613]> ds
[0x556738e61613]> ds
[0x556738e61613]> px @rbp-0xc
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7ffefa3a7a44  0800 0000 0900 0000 0a00 0000 3016 e638  ............0..8
0x7ffefa3a7a54  6755 0000 970b a1b9 cf7f 0000 0100 0000  gU..............
0x7ffefa3a7a64  0000 0000 387b 3afa fe7f 0000 0080 0000  ....8{:.........
0x7ffefa3a7a74  0100 0000 fa15 e638 6755 0000 0000 0000  .......8gU......
0x7ffefa3a7a84  0000 0000 1a35 7d04 73a8 c4bd f014 e638  .....5}.s......8
0x7ffefa3a7a94  6755 0000 307b 3afa fe7f 0000 0000 0000  gU..0{:.........
0x7ffefa3a7aa4  0000 0000 0000 0000 0000 0000 1a35 dddc  .............5..
0x7ffefa3a7ab4  cb2d f7e8 1a35 833e fdaa 95e8 0000 0000  .-...5.>........
0x7ffefa3a7ac4  fe7f 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffefa3a7ad4  0000 0000 3307 dfb9 cf7f 0000 3866 ddb9  ....3.......8f..
0x7ffefa3a7ae4  cf7f 0000 8852 0700 0000 0000 0000 0000  .....R..........
0x7ffefa3a7af4  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffefa3a7b04  0000 0000 f014 e638 6755 0000 307b 3afa  .......8gU..0{:.
0x7ffefa3a7b14  fe7f 0000 1a15 e638 6755 0000 287b 3afa  .......8gU..({:.
0x7ffefa3a7b24  fe7f 0000 1c00 0000 0000 0000 0100 0000  ................
0x7ffefa3a7b34  0000 0000 8387 3afa fe7f 0000 0000 0000  ......:.........
```

Acoording to the writeup loop1.c contains the structure of the loop so lets take a look
```

#include <stdio.h>

int main(void){
  int a = 4;
  int b = 9;
  int c = 10;
  while(a < 9){
    a = a + 2;
  }
return 0;
}

```
If your familiar with c this should be easier to understand

You should have a good grasp on the workflow lets open loop2 afl and pdf @main:
```
[0x7fac7cdb6090]> pdf @main
/ (fcn) main 66
|   int main (int argc, char **argv, char **envp);
|           ; var int32_t var_ch @ rbp-0xc
|           ; var int32_t var_8h @ rbp-0x8
|           ; var int32_t var_4h @ rbp-0x4
|           ; DATA XREF from entry0 (0x56319b12d50d)
|           0x56319b12d5fa      55             pushq %rbp
|           0x56319b12d5fb      4889e5         movq %rsp, %rbp
|           0x56319b12d5fe      c745f4140000.  movl $0x14, var_ch      ; 20
|           0x56319b12d605      c745f8160000.  movl $0x16, var_8h      ; 22
|           0x56319b12d60c      c745fc000000.  movl $0, var_4h
|           0x56319b12d613      c745fc040000.  movl $4, var_4h
|       ,=< 0x56319b12d61a      eb13           jmp 0x56319b12d62f
|      .--> 0x56319b12d61c      8365f402       andl $2, var_ch
|      :|   0x56319b12d620      d17df8         sarl $1, var_8h
|      :|   0x56319b12d623      8b55fc         movl var_4h, %edx
|      :|   0x56319b12d626      89d0           movl %edx, %eax
|      :|   0x56319b12d628      01c0           addl %eax, %eax
|      :|   0x56319b12d62a      01d0           addl %edx, %eax
|      :|   0x56319b12d62c      8945fc         movl %eax, var_4h
|      :|   ; CODE XREF from main (0x56319b12d61a)
|      :`-> 0x56319b12d62f      837dfc63       cmpl $0x63, var_4h      ; 'c'
|      `==< 0x56319b12d633      7ee7           jle 0x56319b12d61c
|           0x56319b12d635      b800000000     movl $0, %eax
|           0x56319b12d63a      5d             popq %rbp
\           0x56319b12d63b      c3             retq
```

You can set a breakpoint at 0x56319b12d623 and examine it at each step of the loop to get the answers:
 ```
[0x56319b12d623]> px @ rbp-0x8
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7fff147eb158  0b00 0000 0c00 0000 40d6 129b 3156 0000  ........@...1V..
0x7fff147eb168  975b 9e7c ac7f 0000 0100 0000 0000 0000  .[.|............
0x7fff147eb178  48b2 7e14 ff7f 0000 0080 0000 0100 0000  H.~.............
0x7fff147eb188  fad5 129b 3156 0000 0000 0000 0000 0000  ....1V..........
0x7fff147eb198  cbe1 1b46 3433 a188 f0d4 129b 3156 0000  ...F43......1V..
0x7fff147eb1a8  40b2 7e14 ff7f 0000 0000 0000 0000 0000  @.~.............
0x7fff147eb1b8  0000 0000 0000 0000 cbe1 7b88 ec2d 3cdb  ..........{..-<.
0x7fff147eb1c8  cbe1 055c 2dfc 9adb 0000 0000 ff7f 0000  ...\-...........
0x7fff147eb1d8  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb1e8  3357 dc7c ac7f 0000 38b6 da7c ac7f 0000  3W.|....8..|....
0x7fff147eb1f8  767c 0700 0000 0000 0000 0000 0000 0000  v|..............
0x7fff147eb208  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb218  f0d4 129b 3156 0000 40b2 7e14 ff7f 0000  ....1V..@.~.....
0x7fff147eb228  1ad5 129b 3156 0000 38b2 7e14 ff7f 0000  ....1V..8.~.....
0x7fff147eb238  1c00 0000 0000 0000 0100 0000 0000 0000  ................
0x7fff147eb248  83c7 7e14 ff7f 0000 0000 0000 0000 0000  ..~.............
[0x56319b12d623]> ds
[0x56319b12d623]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
hit breakpoint at: 56319b12d623
[0x56319b12d61c]> px @ rbp-0x8
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7fff147eb158  0500 0000 0c00 0000 40d6 129b 3156 0000  ........@...1V..
0x7fff147eb168  975b 9e7c ac7f 0000 0100 0000 0000 0000  .[.|............
0x7fff147eb178  48b2 7e14 ff7f 0000 0080 0000 0100 0000  H.~.............
0x7fff147eb188  fad5 129b 3156 0000 0000 0000 0000 0000  ....1V..........
0x7fff147eb198  cbe1 1b46 3433 a188 f0d4 129b 3156 0000  ...F43......1V..
0x7fff147eb1a8  40b2 7e14 ff7f 0000 0000 0000 0000 0000  @.~.............
0x7fff147eb1b8  0000 0000 0000 0000 cbe1 7b88 ec2d 3cdb  ..........{..-<.
0x7fff147eb1c8  cbe1 055c 2dfc 9adb 0000 0000 ff7f 0000  ...\-...........
0x7fff147eb1d8  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb1e8  3357 dc7c ac7f 0000 38b6 da7c ac7f 0000  3W.|....8..|....
0x7fff147eb1f8  767c 0700 0000 0000 0000 0000 0000 0000  v|..............
0x7fff147eb208  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb218  f0d4 129b 3156 0000 40b2 7e14 ff7f 0000  ....1V..@.~.....
0x7fff147eb228  1ad5 129b 3156 0000 38b2 7e14 ff7f 0000  ....1V..8.~.....
0x7fff147eb238  1c00 0000 0000 0000 0100 0000 0000 0000  ................
0x7fff147eb248  83c7 7e14 ff7f 0000 0000 0000 0000 0000  ..~.............

[0x56319b12d61c]> px @ rbp-0xc
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7fff147eb154  0000 0000 0500 0000 0c00 0000 40d6 129b  ............@...
0x7fff147eb164  3156 0000 975b 9e7c ac7f 0000 0100 0000  1V...[.|........
0x7fff147eb174  0000 0000 48b2 7e14 ff7f 0000 0080 0000  ....H.~.........
0x7fff147eb184  0100 0000 fad5 129b 3156 0000 0000 0000  ........1V......
0x7fff147eb194  0000 0000 cbe1 1b46 3433 a188 f0d4 129b  .......F43......
0x7fff147eb1a4  3156 0000 40b2 7e14 ff7f 0000 0000 0000  1V..@.~.........
0x7fff147eb1b4  0000 0000 0000 0000 0000 0000 cbe1 7b88  ..............{.
0x7fff147eb1c4  ec2d 3cdb cbe1 055c 2dfc 9adb 0000 0000  .-<....\-.......
0x7fff147eb1d4  ff7f 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb1e4  0000 0000 3357 dc7c ac7f 0000 38b6 da7c  ....3W.|....8..|
0x7fff147eb1f4  ac7f 0000 767c 0700 0000 0000 0000 0000  ....v|..........
0x7fff147eb204  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb214  0000 0000 f0d4 129b 3156 0000 40b2 7e14  ........1V..@.~.
0x7fff147eb224  ff7f 0000 1ad5 129b 3156 0000 38b2 7e14  ........1V..8.~.
0x7fff147eb234  ff7f 0000 1c00 0000 0000 0000 0100 0000  ................
0x7fff147eb244  0000 0000 83c7 7e14 ff7f 0000 0000 0000  ......~.........



[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
[0x56319b12d61c]> ds
hit breakpoint at: 56319b12d623
[0x56319b12d61c]> px @ rbp-0x8
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7fff147eb158  0200 0000 2400 0000 40d6 129b 3156 0000  ....$...@...1V..
0x7fff147eb168  975b 9e7c ac7f 0000 0100 0000 0000 0000  .[.|............
0x7fff147eb178  48b2 7e14 ff7f 0000 0080 0000 0100 0000  H.~.............
0x7fff147eb188  fad5 129b 3156 0000 0000 0000 0000 0000  ....1V..........
0x7fff147eb198  cbe1 1b46 3433 a188 f0d4 129b 3156 0000  ...F43......1V..
0x7fff147eb1a8  40b2 7e14 ff7f 0000 0000 0000 0000 0000  @.~.............
0x7fff147eb1b8  0000 0000 0000 0000 cbe1 7b88 ec2d 3cdb  ..........{..-<.
0x7fff147eb1c8  cbe1 055c 2dfc 9adb 0000 0000 ff7f 0000  ...\-...........
0x7fff147eb1d8  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb1e8  3357 dc7c ac7f 0000 38b6 da7c ac7f 0000  3W.|....8..|....
0x7fff147eb1f8  767c 0700 0000 0000 0000 0000 0000 0000  v|..............
0x7fff147eb208  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb218  f0d4 129b 3156 0000 40b2 7e14 ff7f 0000  ....1V..@.~.....
0x7fff147eb228  1ad5 129b 3156 0000 38b2 7e14 ff7f 0000  ....1V..8.~.....
0x7fff147eb238  1c00 0000 0000 0000 0100 0000 0000 0000  ................
0x7fff147eb248  83c7 7e14 ff7f 0000 0000 0000 0000 0000  ..~.............
[0x56319b12d61c]> px @ rbp-0xc
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7fff147eb154  0000 0000 0200 0000 2400 0000 40d6 129b  ........$...@...
0x7fff147eb164  3156 0000 975b 9e7c ac7f 0000 0100 0000  1V...[.|........
0x7fff147eb174  0000 0000 48b2 7e14 ff7f 0000 0080 0000  ....H.~.........
0x7fff147eb184  0100 0000 fad5 129b 3156 0000 0000 0000  ........1V......
0x7fff147eb194  0000 0000 cbe1 1b46 3433 a188 f0d4 129b  .......F43......
0x7fff147eb1a4  3156 0000 40b2 7e14 ff7f 0000 0000 0000  1V..@.~.........
0x7fff147eb1b4  0000 0000 0000 0000 0000 0000 cbe1 7b88  ..............{.
0x7fff147eb1c4  ec2d 3cdb cbe1 055c 2dfc 9adb 0000 0000  .-<....\-.......
0x7fff147eb1d4  ff7f 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb1e4  0000 0000 3357 dc7c ac7f 0000 38b6 da7c  ....3W.|....8..|
0x7fff147eb1f4  ac7f 0000 767c 0700 0000 0000 0000 0000  ....v|..........
0x7fff147eb204  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7fff147eb214  0000 0000 f0d4 129b 3156 0000 40b2 7e14  ........1V..@.~.
0x7fff147eb224  ff7f 0000 1ad5 129b 3156 0000 38b2 7e14  ........1V..8.~.
0x7fff147eb234  ff7f 0000 1c00 0000 0000 0000 0100 0000  ................
0x7fff147eb244  0000 0000 83c7 7e14 ff7f 0000 0000 0000  ......~.........
```

What is the value of var_8h on the second iteration of the loop?
5
What is the value of var_ch on the second iteration of the loop?
0
What is the value of var_8h at the end of the program?
2
What is the value of var_ch at the end of the program?
0




task 6: crackme1


Command = r2 -d crackme1

```
[0x7fb1d6e28090]> afl
0x564b8f9bd6f0    1 42           entry0
0x564b8fbbdfe0    1 4124         reloc.__libc_start_main
0x564b8f9bd720    4 50   -> 40   sym.deregister_tm_clones
0x564b8f9bd760    4 66   -> 57   sym.register_tm_clones
0x564b8f9bd7b0    5 58   -> 51   entry.fini0
0x564b8f9bd6e0    1 6            sym..plt.got
0x564b8f9bd7f0    1 10           entry.init0
0x564b8f9bd990    1 2            sym.__libc_csu_fini
0x564b8f9bd994    1 9            sym._fini
0x564b8f9bd920    4 101          sym.__libc_csu_init
0x564b8f9bd7fa   10 280          main
0x564b8f9bd650    3 23           sym._init
0x564b8f9bd680    1 6            sym.imp.puts
0x564b8f9bd690    1 6            sym.imp.strlen
0x564b8f9bd6a0    1 6            sym.imp.__stack_chk_fail
0x564b8f9bd000    2 25           map.home_tryhackme_crackme_crackme1.r_x
0x564b8f9bd6b0    1 6            sym.imp.strcmp
0x564b8f9bd6c0    1 6            sym.imp.strtok
0x564b8f9bd6d0    1 6            sym.imp.__isoc99_scanf

[0x7fb1d6e28090]> pdf @main
/ (fcn) main 280
|   int main (int argc, char **argv, char **envp);
|           ; var int32_t var_54h @ rbp-0x54
|           ; var int32_t var_50h @ rbp-0x50
|           ; var int32_t var_4ch @ rbp-0x4c
|           ; var int32_t var_48h @ rbp-0x48
|           ; var int32_t var_40h @ rbp-0x40
|           ; var int32_t var_38h @ rbp-0x38
|           ; var int32_t var_30h @ rbp-0x30
|           ; var int32_t var_28h @ rbp-0x28
|           ; var int32_t var_12h @ rbp-0x12
|           ; var int32_t var_8h @ rbp-0x8
|           ; arg int32_t arg_40h @ rbp+0x40
|           ; DATA XREF from entry0 (0x564b8f9bd70d)
|           0x564b8f9bd7fa      55             pushq %rbp
|           0x564b8f9bd7fb      4889e5         movq %rsp, %rbp
|           0x564b8f9bd7fe      4883ec60       subq $0x60, %rsp        ; '`'
|           0x564b8f9bd802      64488b042528.  movq %fs:0x28, %rax     ; [0x28:8]=-1 ; '(' ; 40
|           0x564b8f9bd80b      488945f8       movq %rax, var_8h
|           0x564b8f9bd80f      31c0           xorl %eax, %eax
|           0x564b8f9bd811      488d3d900100.  leaq str.enter_your_password, %rdi ; 0x564b8f9bd9a8 ; "enter your password"
|           0x564b8f9bd818      e863feffff     callq sym.imp.puts      ; int puts(const char *s)
|           0x564b8f9bd81d      488d45ee       leaq var_12h, %rax
|           0x564b8f9bd821      4889c6         movq %rax, %rsi
|           0x564b8f9bd824      488d3d910100.  leaq 0x564b8f9bd9bc, %rdi ; "%s"
|           0x564b8f9bd82b      b800000000     movl $0, %eax
|           0x564b8f9bd830      e89bfeffff     callq sym.imp.__isoc99_scanf ; int scanf(const char *format)
|           0x564b8f9bd835      c745ac000000.  movl $0, var_54h
|           0x564b8f9bd83c      488d057c0100.  leaq 0x564b8f9bd9bf, %rax ; "127"
|           0x564b8f9bd843      488945c0       movq %rax, var_40h
|           0x564b8f9bd847      488d05750100.  leaq str.01., %rax      ; 0x564b8f9bd9c3 ; u"01.\u7257\u6e6f\u2067\u6150\u7373\u6f77\u6472\u5900\u756f\u7627\u2065\u6f67\u2074\u6874\u2065\u6f63\u7272\u6365\u2074\u6170\u7373\u6f77\u6472\u0100\u031b\u3c3b"
|           0x564b8f9bd84e      488945c8       movq %rax, var_38h
|           0x564b8f9bd852      488d056a0100.  leaq str.01., %rax      ; 0x564b8f9bd9c3 ; u"01.\u7257\u6e6f\u2067\u6150\u7373\u6f77\u6472\u5900\u756f\u7627\u2065\u6f67\u2074\u6874\u2065\u6f63\u7272\u6365\u2074\u6170\u7373\u6f77\u6472\u0100\u031b\u3c3b"
|           0x564b8f9bd859      488945d0       movq %rax, var_30h
|           0x564b8f9bd85d      488d05610100.  leaq 0x564b8f9bd9c5, %rax ; u"1.\u7257\u6e6f\u2067\u6150\u7373\u6f77\u6472\u5900\u756f\u7627\u2065\u6f67\u2074\u6874\u2065\u6f63\u7272\u6365\u2074\u6170\u7373\u6f77\u6472\u0100\u031b\u3c3b"
|           0x564b8f9bd864      488945d8       movq %rax, var_28h
|           0x564b8f9bd868      488d45ee       leaq var_12h, %rax
|           0x564b8f9bd86c      4889c7         movq %rax, %rdi
|           0x564b8f9bd86f      e81cfeffff     callq sym.imp.strlen    ; size_t strlen(const char *s)
|           0x564b8f9bd874      8945b0         movl %eax, var_50h
|           0x564b8f9bd877      488d45ee       leaq var_12h, %rax
|           0x564b8f9bd87b      488d35450100.  leaq 0x564b8f9bd9c7, %rsi ; "."
|           0x564b8f9bd882      4889c7         movq %rax, %rdi
|           0x564b8f9bd885      e836feffff     callq sym.imp.strtok    ; char *strtok(char *s1, const char *s2)
|           0x564b8f9bd88a      488945b8       movq %rax, var_48h
|       ,=< 0x564b8f9bd88e      eb4e           jmp 0x564b8f9bd8de
|      .--> 0x564b8f9bd890      8b45ac         movl var_54h, %eax
|      :|   0x564b8f9bd893      4898           cltq
|      :|   0x564b8f9bd895      488b54c5c0     movq -0x40(%rbp, %rax, 8), %rdx
|      :|   0x564b8f9bd89a      488b45b8       movq var_48h, %rax
|      :|   0x564b8f9bd89e      4889d6         movq %rdx, %rsi
|      :|   0x564b8f9bd8a1      4889c7         movq %rax, %rdi
|      :|   0x564b8f9bd8a4      e807feffff     callq sym.imp.strcmp    ; int strcmp(const char *s1, const char *s2)
|      :|   0x564b8f9bd8a9      8945b4         movl %eax, var_4ch
|      :|   0x564b8f9bd8ac      8345ac01       addl $1, var_54h
|      :|   0x564b8f9bd8b0      837db400       cmpl $0, var_4ch
|     ,===< 0x564b8f9bd8b4      7413           je 0x564b8f9bd8c9
|     |:|   0x564b8f9bd8b6      488d3d0c0100.  leaq 0x564b8f9bd9c9, %rdi ; "Wrong Password"
|     |:|   0x564b8f9bd8bd      e8befdffff     callq sym.imp.puts      ; int puts(const char *s)
|     |:|   0x564b8f9bd8c2      b8ffffffff     movl $0xffffffff, %eax  ; -1
|    ,====< 0x564b8f9bd8c7      eb33           jmp 0x564b8f9bd8fc
|    |`---> 0x564b8f9bd8c9      488d35f70000.  leaq 0x564b8f9bd9c7, %rsi ; "."
|    | :|   0x564b8f9bd8d0      bf00000000     movl $0, %edi
|    | :|   0x564b8f9bd8d5      e8e6fdffff     callq sym.imp.strtok    ; char *strtok(char *s1, const char *s2)
|    | :|   0x564b8f9bd8da      488945b8       movq %rax, var_48h
|    | :|   ; CODE XREF from main (0x564b8f9bd88e)
|    | :`-> 0x564b8f9bd8de      48837db800     cmpq $0, var_48h
|    | :,=< 0x564b8f9bd8e3      7406           je 0x564b8f9bd8eb
|    | :|   0x564b8f9bd8e5      837dac03       cmpl $3, var_54h
|    | `==< 0x564b8f9bd8e9      7ea5           jle 0x564b8f9bd890
|    |  `-> 0x564b8f9bd8eb      488d3de60000.  leaq str.You_ve_got_the_correct_password, %rdi ; 0x564b8f9bd9d8 ; "You've got the correct password"
|    |      0x564b8f9bd8f2      e889fdffff     callq sym.imp.puts      ; int puts(const char *s)
|    |      0x564b8f9bd8f7      b800000000     movl $0, %eax
|    |      ; CODE XREF from main (0x564b8f9bd8c7)
|    `----> 0x564b8f9bd8fc      488b4df8       movq var_8h, %rcx
|           0x564b8f9bd900      6448330c2528.  xorq %fs:0x28, %rcx
|       ,=< 0x564b8f9bd909      7405           je 0x564b8f9bd910
|       |   0x564b8f9bd90b      e890fdffff     callq sym.imp.__stack_chk_fail ; void __stack_chk_fail(void)
|       `-> 0x564b8f9bd910      c9             leave
\           0x564b8f9bd911      c3   ```
|    | `==< 0x564b8f9bd8e9      7ea5           jle 0x564b8f9bd890
|    |  `-> 0x564b8f9bd8eb      488d3de60000.  leaq str.You_ve_got_the_correct_password, %rdi ; 0x564b8f9bd9d8 ; "You've got the correct password"
|    |      0x564b8f9bd8f2      e889fdffff     callq sym.imp.puts      ; int puts(const char *s)
|     ,===< 0x564b8f9bd8b4      7413           je 0x564b8f9bd8c9
|     |:|   0x564b8f9bd8b6      488d3d0c0100.  leaq 0x564b8f9bd9c9, %rdi ; "Wrong Password"
|     |:|   0x564b8f9bd8bd      e8befdffff     callq sym.imp.puts      ; int puts(const char *s)```
```
The program runs until the correct password is entered lets see if we can find it.
lets put a breakpoint at the strcmp line

```

[0x7fb1d6e28090]> db 0x564b8f9bd8a4      
[0x7fb1d6e28090]> dc
enter your password
woooo
hit breakpoint at: 0x564b8f9bd8a4
[0x564b8f9bd8a4]> px rsi
Block size 672283071 is too big
[0x564b8f9bd8a4]> px %rsi
[0x564b8f9bd8a4]> px @ rsi
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x55f4281239bf  3132 3700 3000 3100 2e00 5772 6f6e 6720  127.0.1...Wrong 
0x55f4281239cf  5061 7373 776f 7264 0059 6f75 2776 6520  Password.You've 
0x55f4281239df  676f 7420 7468 6520 636f 7272 6563 7420  got the correct 
0x55f4281239ef  7061 7373 776f 7264 0001 1b03 3b3c 0000  password....;<..
0x55f4281239ff  0006 0000 0078 fcff ff88 0000 00e8 fcff  .....x..........
0x55f428123a0f  ffb0 0000 00f8 fcff ff58 0000 0002 feff  .........X......
0x55f428123a1f  ffc8 0000 0028 ffff ffe8 0000 0098 ffff  .....(..........
0x55f428123a2f  ff30 0100 0000 0000 0014 0000 0000 0000  .0..............
0x55f428123a3f  0001 7a52 0001 7810 011b 0c07 0890 0107  ..zR..x.........
0x55f428123a4f  1014 0000 001c 0000 0098 fcff ff2b 0000  .............+..
0x55f428123a5f  0000 0000 0000 0000 0014 0000 0000 0000  ................
0x55f428123a6f  0001 7a52 0001 7810 011b 0c07 0890 0100  ..zR..x.........
0x55f428123a7f  0024 0000 001c 0000 00e8 fbff ff70 0000  .$...........p..
0x55f428123a8f  0000 0e10 460e 184a 0f0b 7708 8000 3f1a  ....F..J..w...?.
0x55f428123a9f  3b2a 3324 2200 0000 0014 0000 0044 0000  ;*3$"........D..
0x55f428123aaf  0030 fcff ff08 0000 0000 0000 0000 0000  .0..............
```
The hex is missing an extra 0 the Answer is local host or 127.0.0.1

task 7: crackme2

```
[0x7fdca4071090]> afl
0x55a3ccc9a6f0    1 42           entry0
0x55a3cce9afe0    1 4124         reloc.__libc_start_main
0x55a3ccc9a720    4 50   -> 40   sym.deregister_tm_clones
0x55a3ccc9a760    4 66   -> 57   sym.register_tm_clones
0x55a3ccc9a7b0    5 58   -> 51   entry.fini0
0x55a3ccc9a6e0    1 6            sym..plt.got
0x55a3ccc9a7f0    1 10           entry.init0
0x55a3ccc9a990    1 2            sym.__libc_csu_fini
0x55a3ccc9a994    1 9            sym._fini
0x55a3ccc9a920    4 101          sym.__libc_csu_init
0x55a3ccc9a7fa   12 283          main
0x55a3ccc9a650    3 23           sym._init
0x55a3ccc9a680    1 6            sym.imp.puts
0x55a3ccc9a690    1 6            sym.imp.fread
0x55a3ccc9a6a0    1 6            sym.imp.strlen
0x55a3ccc9a6b0    1 6            sym.imp.__stack_chk_fail
0x55a3ccc9a000    2 25           map.home_tryhackme_crackme_crackme2.r_x
0x55a3ccc9a6c0    1 6            sym.imp.fopen
0x55a3ccc9a6d0    1 6            sym.imp.__isoc99_scanf
[0x7fdca4071090]> pdf @main
/ (fcn) main 283
|   int main (int argc, char **argv, char **envp);
|           ; var int32_t var_44h @ rbp-0x44
|           ; var int32_t var_40h @ rbp-0x40
|           ; var int32_t var_3ch @ rbp-0x3c
|           ; var int32_t var_38h @ rbp-0x38
|           ; var int32_t var_2eh @ rbp-0x2e
|           ; var int32_t var_23h @ rbp-0x23
|           ; var int32_t var_18h @ rbp-0x18
|           ; DATA XREF from entry0 (0x55a3ccc9a70d)
|           0x55a3ccc9a7fa      55             pushq %rbp
|           0x55a3ccc9a7fb      4889e5         movq %rsp, %rbp
|           0x55a3ccc9a7fe      53             pushq %rbx
|           0x55a3ccc9a7ff      4883ec48       subq $0x48, %rsp        ; 'H'
|           0x55a3ccc9a803      64488b042528.  movq %fs:0x28, %rax     ; [0x28:8]=-1 ; '(' ; 40
|           0x55a3ccc9a80c      488945e8       movq %rax, var_18h
|           0x55a3ccc9a810      31c0           xorl %eax, %eax
|           0x55a3ccc9a812      488d358f0100.  leaq 0x55a3ccc9a9a8, %rsi ; "r"
|           0x55a3ccc9a819      488d3d900100.  leaq str.home_tryhackme_install_files_secret.txt, %rdi ; 0x55a3ccc9a9b0 ; "/home/tryhackme/install-files/secret.txt"
|           0x55a3ccc9a820      e89bfeffff     callq sym.imp.fopen     ; file*fopen(const char *filename, const char *mode)
|           0x55a3ccc9a825      488945c8       movq %rax, var_38h
|           0x55a3ccc9a829      488b55c8       movq var_38h, %rdx
|           0x55a3ccc9a82d      488d45d2       leaq var_2eh, %rax
|           0x55a3ccc9a831      4889d1         movq %rdx, %rcx
|           0x55a3ccc9a834      ba0b000000     movl $0xb, %edx         ; 11
|           0x55a3ccc9a839      be01000000     movl $1, %esi
|           0x55a3ccc9a83e      4889c7         movq %rax, %rdi
|           0x55a3ccc9a841      e84afeffff     callq sym.imp.fread     ; size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)
|           0x55a3ccc9a846      8945c4         movl %eax, var_3ch
|           0x55a3ccc9a849      837dc400       cmpl $0, var_3ch
|       ,=< 0x55a3ccc9a84d      7916           jns 0x55a3ccc9a865
|       |   0x55a3ccc9a84f      488d3d830100.  leaq str.Error_Reading_File, %rdi ; 0x55a3ccc9a9d9 ; "Error Reading File"
|       |   0x55a3ccc9a856      e825feffff     callq sym.imp.puts      ; int puts(const char *s)
|       |   0x55a3ccc9a85b      b8ffffffff     movl $0xffffffff, %eax  ; -1
|      ,==< 0x55a3ccc9a860      e995000000     jmp 0x55a3ccc9a8fa
|      |`-> 0x55a3ccc9a865      488d3d800100.  leaq str.Please_enter_password, %rdi ; 0x55a3ccc9a9ec ; "Please enter password"
|      |    0x55a3ccc9a86c      e80ffeffff     callq sym.imp.puts      ; int puts(const char *s)
|      |    0x55a3ccc9a871      488d45dd       leaq var_23h, %rax
|      |    0x55a3ccc9a875      4889c6         movq %rax, %rsi
|      |    0x55a3ccc9a878      488d3d830100.  leaq str.11s, %rdi      ; 0x55a3ccc9aa02 ; "%11s"
|      |    0x55a3ccc9a87f      b800000000     movl $0, %eax
|      |    0x55a3ccc9a884      e847feffff     callq sym.imp.__isoc99_scanf ; int scanf(const char *format)
|      |    0x55a3ccc9a889      c745bc090000.  movl $9, var_44h
|      |    0x55a3ccc9a890      c745c0000000.  movl $0, var_40h
|      |,=< 0x55a3ccc9a897      eb33           jmp 0x55a3ccc9a8cc
|     .---> 0x55a3ccc9a899      8b45bc         movl var_44h, %eax
|     :||   0x55a3ccc9a89c      4898           cltq
|     :||   0x55a3ccc9a89e      0fb65405d2     movzbl -0x2e(%rbp, %rax), %edx
|     :||   0x55a3ccc9a8a3      8b45c0         movl var_40h, %eax
|     :||   0x55a3ccc9a8a6      4898           cltq
|     :||   0x55a3ccc9a8a8      0fb64405dd     movzbl -0x23(%rbp, %rax), %eax
|     :||   0x55a3ccc9a8ad      38c2           cmpb %al, %dl
|    ,====< 0x55a3ccc9a8af      7413           je 0x55a3ccc9a8c4
|    |:||   0x55a3ccc9a8b1      488d3d4f0100.  leaq str.Wrong_Password, %rdi ; 0x55a3ccc9aa07 ; "Wrong Password"
|    |:||   0x55a3ccc9a8b8      e8c3fdffff     callq sym.imp.puts      ; int puts(const char *s)
|    |:||   0x55a3ccc9a8bd      b8ffffffff     movl $0xffffffff, %eax  ; -1
|   ,=====< 0x55a3ccc9a8c2      eb36           jmp 0x55a3ccc9a8fa
|   |`----> 0x55a3ccc9a8c4      836dbc01       subl $1, var_44h
|   | :||   0x55a3ccc9a8c8      8345c001       addl $1, var_40h
|   | :||   ; CODE XREF from main (0x55a3ccc9a897)
|   | :|`-> 0x55a3ccc9a8cc      837dbc00       cmpl $0, var_44h
|   | :|,=< 0x55a3ccc9a8d0      7e17           jle 0x55a3ccc9a8e9
|   | :||   0x55a3ccc9a8d2      8b45c0         movl var_40h, %eax
|   | :||   0x55a3ccc9a8d5      4863d8         movslq %eax, %rbx
|   | :||   0x55a3ccc9a8d8      488d45dd       leaq var_23h, %rax
|   | :||   0x55a3ccc9a8dc      4889c7         movq %rax, %rdi
|   | :||   0x55a3ccc9a8df      e8bcfdffff     callq sym.imp.strlen    ; size_t strlen(const char *s)
|   | :||   0x55a3ccc9a8e4      4839c3         cmpq %rax, %rbx
|   | `===< 0x55a3ccc9a8e7      72b0           jb 0x55a3ccc9a899
|   |  |`-> 0x55a3ccc9a8e9      488d3d260100.  leaq str.Correct_Password, %rdi ; 0x55a3ccc9aa16 ; "Correct Password"
|   |  |    0x55a3ccc9a8f0      e88bfdffff     callq sym.imp.puts      ; int puts(const char *s)
|   |  |    0x55a3ccc9a8f5      b800000000     movl $0, %eax
|   |  |    ; CODE XREFS from main (0x55a3ccc9a860, 0x55a3ccc9a8c2)
|   `--`--> 0x55a3ccc9a8fa      488b4de8       movq var_18h, %rcx
|           0x55a3ccc9a8fe      6448330c2528.  xorq %fs:0x28, %rcx
|       ,=< 0x55a3ccc9a907      7405           je 0x55a3ccc9a90e
|       |   0x55a3ccc9a909      e8a2fdffff     callq sym.imp.__stack_chk_fail ; void __stack_chk_fail(void)
|       `-> 0x55a3ccc9a90e      4883c448       addq $0x48, %rsp        ; 'H'
|           0x55a3ccc9a912      5b             popq %rbx
|           0x55a3ccc9a913      5d             popq %rbp
\           0x55a3ccc9a914      c3             retq
|   | :||   0x55a3ccc9a8e4      4839c3         cmpq %rax, %rbx
|   | `===< 0x55a3ccc9a8e7      72b0           jb 0x55a3ccc9a899
|   |  |`-> 0x55a3ccc9a8e9      488d3d260100.  leaq str.Correct_Password, %rdi ; 0x55a3ccc9aa16 ; "Correct Password" ```
```

This program has the password stored in a string "str.Correct_Password" and has a cmpq " Compare" instruction above it lets set a break point at the cmpq instruction and see what we find. 

```
[0x7fdca4071090]> db 0x55a3ccc9a8e4
[0x7fdca4071090]> dc
Please enter password
pass
hit breakpoint at: 55a3ccc9a8e4
[0x55a3ccc9a8e4]> px rax
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x55a3ccc9a8e4  4839 c372                                H9.r
[0x55a3ccc9a8e4]> px rbx
[0x55a3ccc9a8e4]> px @ rbp-0x44
- offset -       0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x7ffdfb6e5a9c  0900 0000 0000 0000 0b00 0000 60d2 fdcd  ............`...
0x7ffdfb6e5aac  a355 0000 a009 7673 3363 7572 6570 7764  .U....vs3curepwd
0x7ffdfb6e5abc  0a70 6173 7300 c9cc a355 0000 00ae ded5  .pass....U......
0x7ffdfb6e5acc  5760 23d6 c05b 6efb fd7f 0000 0000 0000  W`#..[n.........
0x7ffdfb6e5adc  0000 0000 20a9 c9cc a355 0000 970b caa3  .... ....U......
0x7ffdfb6e5aec  dc7f 0000 0100 0000 0000 0000 c85b 6efb  .............[n.
0x7ffdfb6e5afc  fd7f 0000 0080 0000 0100 0000 faa7 c9cc  ................
0x7ffdfb6e5b0c  a355 0000 0000 0000 0000 0000 b0fe f81b  .U..............
0x7ffdfb6e5b1c  3908 c767 f0a6 c9cc a355 0000 c05b 6efb  9..g.....U...[n.
0x7ffdfb6e5b2c  fd7f 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffdfb6e5b3c  0000 0000 b0fe 58fc 7667 7b33 b0fe 265f  ......X.vg{3..&_
0x7ffdfb6e5b4c  3ed6 3933 0000 0000 fd7f 0000 0000 0000  >.93............
0x7ffdfb6e5b5c  0000 0000 0000 0000 0000 0000 3307 08a4  ............3...
0x7ffdfb6e5b6c  dc7f 0000 3866 06a4 dc7f 0000 d03c 0800  ....8f.......<..
0x7ffdfb6e5b7c  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x7ffdfb6e5b8c  0000 0000 0000 0000 0000 0000 f0a6 c9cc  ................
```
This prints out vs3curepwd but this is not the correct answer. The program is reversing it to dwperuc3sv. 
 
